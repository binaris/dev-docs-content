---
title: Writing Backend Logic
route: writing-backend-logic
description: 'Writing backend logic for Reshuffle'
category: 'Main Concepts'
priority: 2
numbered: true
---

# Writing Backend Logic

> This section continues work started in [Writing Frontend Logic.](./writing-frontend-logic) 

In this section, we’ll write our first Reshuffle backend and learn how to store persistent data using Reshuffle DB. There are two concepts you should understand before writing backend code with Reshuffle:

1. [Writing backend (serverside) logic](#writing-backend-logic-with-reshuffle)
2. [Storing persistent data with Reshuffle](#reshuffle-db)

<br />

## Writing Backend Logic with Reshuffle

To write backend logic, you’ll need to utilize the “Reshuffle code macro”. This macro (specifically a babel macro), enables the Reshuffle framework to identify and extract explicitly “exposed” portions of code. These portions are then auto-magically uploaded (and made available) in the backend runtime. Here’s an example demonstrating the basic usage:

<div style="text-align: right;"><span style="padding: 1%; background-color: rgba(35, 191, 98, 0.5)"> backend/helloServer.js  ↓</span></div>

```jsx
/* @expose */
export async function hello(someWord) {
 return `Hello ${someWord}`;
}
```

That’s all it takes to turn your ordinary JavaScript into an always-available cloud service with Reshuffle (pretty cool huh). Here are some things you should be aware of when using the macro:

**1. Any Reshuffle backend function that will be used by the frontend, must have the `@expose` tag and be exported using ES6 export/import semantics.**
	
<div className='good-example'> GOOD (has both export and @expose) </div>

```js
/* @expose */
export async function hello(someWord) {
```

***

<div className='bad-example'> NOT GOOD (missing @expose) </div>

```js
export async function hello(someWord) {
```

***

<div className='bad-example'> NOT GOOD  (missing export) </div>

```js
/* @expose */
async function hello(someWord) {
```

**2. Reshuffle backend logic can only be written in a file that resides in the `backend` directory, or some subdirectory of the `backend` directory. Furthermore, the backend directory itself must reside laterally (not inside) to the `src` directory generated by CRA.**

<div className='good-example'> GOOD (helloServer.js is in the right place, backend directory is in the right place) </div>

![](https://raw.githubusercontent.com/binaris/dev-docs-content/master/assets/good-backend-placement.png?token=AGTTQOSCLF6YRADWT57JAKS5SOIAA)


<div className='bad-example'> NOT GOOD  (helloServer.js resides outside of the backend directory) </div>

![](https://raw.githubusercontent.com/binaris/dev-docs-content/master/assets/bad-backend-file-placement.png?token=AGTTQOTVPHNO3UJLM2S7N3K5SOH7Y)


<div className='bad-example'> NOT GOOD  (backend directory cannot reside inside of src) </div>

![](https://raw.githubusercontent.com/binaris/dev-docs-content/master/assets/bad-backend-dir-placement.png?token=AGTTQOXA44ETKPQTAFEW23S5SOH7Q)

**3. Reshuffle supports npm modules out of the box, just make sure to include them in your root package.json (and install them as you would normally using npm install).**

**4. Importing frontend code into backend files is currently not supported.**

The macro covers how we write backend code, but we still don’t have a way to persist data. Enter, Reshuffle DB.

## Reshuffle DB

Reshuffle DB is a fully managed database with intuitive  semantics. The goal of Reshuffle DB is to get out of your way as much as possible, so great lengths have been taken to abstract away unneeded complexity. What’s left, is a simple interface that provides all the functionality needed to store critical application data. Here is the previous helloServer example, amended to use Reshuffle DB.

<div style="text-align: right;"><span style="padding: 1%; background-color: rgba(35, 191, 98, 0.5)"> backend/helloServer.js  ↓</span></div>

```js
import { get } from '@reshuffle/db';
 
/* @expose */
export async function hello() {
 const someWord = await get('someWord') || 'backup';
 return `Hello ${someWord}`;
}
```

There are no config or migration files, “it just works”. Just as with the macro, there are some things to consider when using Reshuffle DB. 

1. The DB can only be used from a Reshuffle backend (anywhere that a Reshuffle macro is valid, the DB is valid).

2. Reshuffle DB has a Promise based interface, this means that you’ll either need to handle the Promises directly, or use `async`/`await` semantics.

If you would like to learn more about Reshuffle DB, please refer to the [reference docs.](https://dev-docs.reshuffle.com)

<br />

[In the next section, we will use what we learned to build the backend shown in the hello Reshuffle app!](./building-the-hello-reshuffle-backend)

<br />
